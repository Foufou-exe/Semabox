<!DOCTYPE html>
<html class="writer-html5" lang="fr" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>API module &mdash; Documentation Semabox 2.0.0</title>
      <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script src="../../_static/sphinx_highlight.js"></script>
        <script src="../../_static/translations.js"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Recherche" href="../../search.html" />
    <link rel="next" title="SemaOS" href="../SemaOS/modules.html" />
    <link rel="prev" title="SemaAPI" href="modules.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../../index.html" class="icon icon-home"> Semabox
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Rechercher docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../install/modules.html">install</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Semabox/modules.html">Semabox</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="modules.html">SemaAPI</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">API module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#API.about"><code class="docutils literal notranslate"><span class="pre">about()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#API.add_script"><code class="docutils literal notranslate"><span class="pre">add_script()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#API.after_request"><code class="docutils literal notranslate"><span class="pre">after_request()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#API.catch_all"><code class="docutils literal notranslate"><span class="pre">catch_all()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#API.create_script"><code class="docutils literal notranslate"><span class="pre">create_script()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#API.index"><code class="docutils literal notranslate"><span class="pre">index()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#API.page_not_found"><code class="docutils literal notranslate"><span class="pre">page_not_found()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#API.page_not_found2"><code class="docutils literal notranslate"><span class="pre">page_not_found2()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#API.page_not_found3"><code class="docutils literal notranslate"><span class="pre">page_not_found3()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#API.page_not_found4"><code class="docutils literal notranslate"><span class="pre">page_not_found4()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#API.tools"><code class="docutils literal notranslate"><span class="pre">tools()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../SemaOS/modules.html">SemaOS</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">Semabox</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home"></a></li>
          <li class="breadcrumb-item"><a href="modules.html">SemaAPI</a></li>
      <li class="breadcrumb-item active">API module</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../_sources/source/SemaAPI/API.rst.txt" rel="nofollow"> Afficher la source de la page</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="module-API">
<span id="api-module"></span><h1>API module<a class="headerlink" href="#module-API" title="Lien permanent vers cette rubrique"></a></h1>
<p>Description de l’application Flask:</p>
<p>Ceci est une application Flask qui expose une API REST permettant d’exécuter des scripts Python et de retourner leur sortie sous forme de chaîne de caractères JSON.</p>
<p>L’API peut être accédée en utilisant trois méthodes HTTP : POST, GET et PUT.
La fonction create_script exécute le script spécifié lorsqu’elle est accédée via une requête POST et retourne une représentation en chaîne de caractères JSON de la sortie du script.</p>
<p>La fonction get_script retourne la même représentation en chaîne de caractères JSON de la sortie du script lorsqu’elle est accédée via une requête GET.</p>
<p>La fonction update_script exécute le script spécifié lorsqu’elle est accédée via une requête PUT et retourne une représentation en chaîne de caractères JSON de la sortie du script.
La sortie du script doit être un dictionnaire Python, sinon un message d’erreur sera retourné.</p>
<p>La fonction get_ip_address du module info_server est importée et utilisée dans les trois fonctions pour récupérer l’adresse IP du serveur.</p>
<dl class="py function">
<dt class="sig sig-object py" id="API.about">
<span class="sig-prename descclassname"><span class="pre">API.</span></span><span class="sig-name descname"><span class="pre">about</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#API.about" title="Lien permanent vers cette définition"></a></dt>
<dd><dl class="simple">
<dt>Description:</dt><dd><p>Cette fonction est un gestionnaire de route pour la page “A propos”. Elle est appelée chaque fois qu’une demande est effectuée sur la page “A propos”.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="API.add_script">
<span class="sig-prename descclassname"><span class="pre">API.</span></span><span class="sig-name descname"><span class="pre">add_script</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ip</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">arg</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#API.add_script" title="Lien permanent vers cette définition"></a></dt>
<dd><dl class="simple">
<dt>Description de la fonction create_script:</dt><dd><p>Cette fonction exécute le script spécifié en utilisant subprocess.run et retourne une représentation en chaîne de caractères JSON de la sortie du script.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="API.after_request">
<span class="sig-prename descclassname"><span class="pre">API.</span></span><span class="sig-name descname"><span class="pre">after_request</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">response</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#API.after_request" title="Lien permanent vers cette définition"></a></dt>
<dd><p>C’est une fonction Flask en Python avec le décorateur &#64;app.after_request qui s’exécute après chaque requête HTTP. 
Il enregistre une chaîne contenant la méthode HTTP, l’URL et le code de statut de la réponse en utilisant la méthode info du journal associé à l’application Flask. 
Finalement, il retourne la réponse HTTP.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="API.catch_all">
<span class="sig-prename descclassname"><span class="pre">API.</span></span><span class="sig-name descname"><span class="pre">catch_all</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#API.catch_all" title="Lien permanent vers cette définition"></a></dt>
<dd><p>Cette fonction est un gestionnaire d’erreur pour l’erreur HTTP 404 (page non trouvée). Elle est appelée chaque fois qu’une demande entraîne une erreur 404.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="API.create_script">
<span class="sig-prename descclassname"><span class="pre">API.</span></span><span class="sig-name descname"><span class="pre">create_script</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">script</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">dict</span></span></span><a class="headerlink" href="#API.create_script" title="Lien permanent vers cette définition"></a></dt>
<dd><dl class="simple">
<dt>Description de la fonction create_script:</dt><dd><p>Cette fonction exécute le script spécifié en utilisant subprocess.run et retourne une représentation en chaîne de caractères JSON de la sortie du script.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="API.index">
<span class="sig-prename descclassname"><span class="pre">API.</span></span><span class="sig-name descname"><span class="pre">index</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#API.index" title="Lien permanent vers cette définition"></a></dt>
<dd><dl class="simple">
<dt>Description de la fonction index:</dt><dd><p>Cette fonction affiche les informations relatives au serveur en exécutant le script “info_server.py” et en récupérant le dictionnaire de résultat.
Si le dictionnaire est vide, une erreur HTTP 404 est retournée avec un message d’erreur personnalisé « Aucune information sur le serveur disponible »
La page html “index.html” est ensuite rendue en utilisant les informations récupérées.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="API.page_not_found">
<span class="sig-prename descclassname"><span class="pre">API.</span></span><span class="sig-name descname"><span class="pre">page_not_found</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">error</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#API.page_not_found" title="Lien permanent vers cette définition"></a></dt>
<dd><p>Cette fonction est un gestionnaire d’erreur pour l’erreur HTTP 404 (page non trouvée). Elle est appelée chaque fois qu’une demande entraîne une erreur 404.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="API.page_not_found2">
<span class="sig-prename descclassname"><span class="pre">API.</span></span><span class="sig-name descname"><span class="pre">page_not_found2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">error</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#API.page_not_found2" title="Lien permanent vers cette définition"></a></dt>
<dd><p>Cette fonction est un gestionnaire d’erreur pour l’erreur HTTP 500 (erreur interne du serveur). Elle est appelée chaque fois qu’une demande entraîne une erreur 500. 
Elle renvoie la réponse générée par le modèle de la page d’erreur HTTP 500, ainsi que le code d’erreur 500.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="API.page_not_found3">
<span class="sig-prename descclassname"><span class="pre">API.</span></span><span class="sig-name descname"><span class="pre">page_not_found3</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">error</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#API.page_not_found3" title="Lien permanent vers cette définition"></a></dt>
<dd><p>Cette fonction est un gestionnaire d’erreur pour l’erreur HTTP 400 (requête incorrecte). Elle est appelée chaque fois qu’une demande entraîne une erreur 400.
Elle renvoie la réponse générée par le modèle de la page d’erreur HTTP 400, ainsi que le code d’erreur 400.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="API.page_not_found4">
<span class="sig-prename descclassname"><span class="pre">API.</span></span><span class="sig-name descname"><span class="pre">page_not_found4</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">error</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#API.page_not_found4" title="Lien permanent vers cette définition"></a></dt>
<dd><p>Cette fonction est un gestionnaire d’erreur pour l’erreur HTTP 501 (fonctionnalité non implémentée). Elle est appelée chaque fois qu’une demande entraîne une erreur 501.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="API.tools">
<span class="sig-prename descclassname"><span class="pre">API.</span></span><span class="sig-name descname"><span class="pre">tools</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#API.tools" title="Lien permanent vers cette définition"></a></dt>
<dd><p>La fonction tools implémente le point d’entrée “/tools” d’une application Flask et gère les requêtes GET et POST.</p>
<p>Pour les requêtes POST, elle met à jour les statuts speedtest_status et scan_status en fonction de la présence de “go” ou “reset” dans la requête.</p>
<p>Pour les requêtes GET, elle met à jour les statuts speedtest_status et scan_status en “reset”.</p>
<p>Elle utilise les fonctions api_get_info_system, api_server_is_up, api_get_public_ip, api_web_speedtest et api_web_scan_nmap pour récupérer diverses informations sur le serveur. Si les informations récupérées ne sont pas valides (vides ou pas des objets dict), elle renvoie une erreur HTTP 404 avec un message d’erreur personnalisé.</p>
<p>Enfin, elle retourne une vue en utilisant le template “Pages/SemaWeb/tools.html” avec les informations récupérées sur le serveur.</p>
</dd></dl>

</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Pied de page">
        <a href="modules.html" class="btn btn-neutral float-left" title="SemaAPI" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Précédent</a>
        <a href="../SemaOS/modules.html" class="btn btn-neutral float-right" title="SemaOS" accesskey="n" rel="next">Suivant <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, Le Quadro.</p>
  </div>

  Compilé avec <a href="https://www.sphinx-doc.org/">Sphinx</a> en utilisant un
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">thème</a>
    fourni par <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>